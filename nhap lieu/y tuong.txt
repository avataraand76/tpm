-làm trang login // done
-làm trang phân quyền // done
-làm chức năng tutorial tour dùng driver.js // pending
-làm trang tạo phiếu xuất nhập // done
-chức năng quét barcode/rfid // pending done QR còn rfid
-làm trang xem lịch sử di chuyển của máy // done
-trang danh sách thiết bị // done
-in mã QR or RFID // pending in được nhưng hold vì không biết khổ giấy

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
nhửng gì đả lèm dc

1.trang danh sách thiết bị
-user khai báo thiết bị, nhập các thông tin: mã máy, serial, rfid, loại, loại máy, model máy, hãng sản xuất,...
-các thông tin giá tiền, tuổi thọ, ngày sử dụng có thể nhập sau
-user có thể in mã QR để dán lên máy

2.trang nhập xuất

tôi muốn chỉnh sửa backend và frontend của phần tạo phiếu, liên quan tới phần cập nhật trạng thái của máy móc khi duyệt phiếu

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
hiện tại trong database
tb_machine:
-trạng thái của máy móc (available, in_use, maintance, liquidation, disabled)
-trạng thái mượn/thuê/cho thuê (borrowed, rented, borrowed_out)

tb_import
-loại phiếu ('internal', 'borrowed', 'rented', 'purchased', 'maintenance_return', 'borrowed_out_return')

tb_export
-loại phiếu ('internal', 'maintenance', 'borrowed_out', 'liquidation', 'borrowed_return', 'rented_return')

1. điều chuyển nội bộ internal
-khi làm phiếu này sẽ tạo 2 phiếu trong database import và export cùng 1 lúc, khi duyệt cũng sẽ duyệt cùng 1 lúc, nhưng trên giao diện sẽ chỉ hiện 1 phiếu là phiếu điều chuyển nội bộ

-điều chuyển nội bộ sẽ không hiện các location có tb_department là '%Đơn vị bên ngoài%'

-nếu điều chuyển nội bộ tới các khu vực có '%kho%', khi duyệt thì set status của máy thành available

-nếu điều chuyển nội bộ tới các khu vực không có '%kho%', khi duyệt thì set status của máy thành in_use

2. làm phiếu nhập mua, bảo trì, trả mượn purchased, maintance_return, borrowed_out_return
-làm các loại phiếu này sẽ chỉ hiện các khu vực có '%kho%', khi duyệt sẽ set status máy là available

-riêng loại phiếu là borrowed_out_return thì sẽ xóa các thông tin is_borrowed_or_rented_or_borrowed_out_name, is_borrowed_or_rented_or_borrowed_out_date, is_borrowed_or_rented_or_borrowed_out_return_date trong tb_machine

3. làm phiếu nhập mượn, thuê borrowed, rented
-làm phiếu này sẽ chỉ hiện các location có '%kho%', khi duyệt sẽ set status là available

-lưu các thông tin is_borrowed_or_rented_or_borrowed_out_name, is_borrowed_or_rented_or_borrowed_out_date, is_borrowed_or_rented_or_borrowed_out_return_date trong tb_machine vào trong tb_machine

4. làm phiếu xuất bảo trì, thanh lí maintance, liquidation
-làm phiếu này sẽ chỉ hiện các location có tb_department là '%Đơn vị bên ngoài%', khi duyệt sẽ set status máy là maintance, liquidation

5. làm phiếu xuất cho mượn borrowed_out
-làm phiếu này sẽ chỉ hiện các location có tb_department là '%Đơn vị bên ngoài%', khi duyệt phiếu sẽ set status disabled

-khi duyệt cũng sẽ lưu thông tin is_borrowed_or_rented_or_borrowed_out_name, is_borrowed_or_rented_or_borrowed_out_date, is_borrowed_or_rented_or_borrowed_out_return_date trong tb_machine vào trong tb_machine

6. làm phiếu trả mượn/thuê borrowed_return, rented_return
-làm phiếu này sẽ chỉ hiện các location có tb_department là '%Đơn vị bên ngoài%', khi duyệt phiếu sẽ set status disabled

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
tôi có tạo các trường hợp status và is_borrowed_or_rented_or_borrowed_out như sau
1 máy có status là available (sẵn sàng)
2 máy có status là in_use (đang sử dụng)
3 máy có status là maintenance (bảo trì)
4 máy có status là liquidation (thanh lý)
5 máy có status là broken (máy hư)
6 máy có status là disabled và is_borrowed_or_rented_or_borrowed_out là borrowed_out (cho mượn)
7 máy có status là available và is_borrowed_or_rented_or_borrowed_out là borrowed (máy mượn)
8 máy có status là in_use và is_borrowed_or_rented_or_borrowed_out là borrowed (máy mượn)
9 máy có status là broken và is_borrowed_or_rented_or_borrowed_out là borrowed (máy mượn)
10 máy có status là available và is_borrowed_or_rented_or_borrowed_out là rented (máy thuê)
11 máy có status là in_use và is_borrowed_or_rented_or_borrowed_out là rented (máy thuê)
12 máy có status là broken và is_borrowed_or_rented_or_borrowed_out là rented (máy thuê)
13 máy có status là disabled và is_borrowed_or_rented_or_borrowed_out là borrowed_return (trả máy mượn)
14 máy có status là disabled và is_borrowed_or_rented_or_borrowed_out là rented_return (trả máy thuê)

chỉnh sửa chức năng tìm kiếm và quét QR chỉ hiện các máy móc theo các trường hợp tạo phiếu nhập, xuất, điều chuyển nội bộ, cập nhật vị trí
a. nhập mua mới (chỉ hiện trường hợp 1)
b. nhập sau bảo trì (chỉ hiện trường hợp 3)
c. nhập thuê (chỉ hiện trường hợp 1,13,14)
d. nhập mượn (chỉ hiện trường hợp 1,13,14)
e. nhập trả (máy cho mượn) (chỉ hiện trường hợp 6)
f. xuất thanh lý (chỉ hiện trường hợp 1,2,5)
g. xuất bảo trì (chỉ hiện trường hợp 1,2,5)
h. xuất cho mượn (chỉ hiện trường hợp 1,2)
i. xuất trả (máy thuê) (chỉ hiện trường hợp 10,11,12)
j. xuất trả (máy mượn) (chỉ hiện trường hợp 7,8,9)
k. điều chuyển nội bộ (chỉ hiện trường hợp 1,2,5,7,8,9,10,11,12)
l. cập nhật vị trí (ko quan tâm status và is_borrowed_or_rented_or_borrowed_out)

Hành động	Admin	Phòng Cơ điện	Cơ điện xưởng	View Only	Người tạo
Xem Tab Kiểm kê	✅	✅	✅	✅	✅
Xem danh sách phiếu	✅	✅	✅	✅	✅
Xem chi tiết phiếu	✅	✅	✅	✅	✅
Tạo phiếu kiểm kê	✅	✅	❌	❌	❌
Thêm đơn vị	✅	✅	❌	❌	✅*
Kiểm kê (Chi tiết)	✅	✅	✅	❌	✅
Gửi duyệt	✅	✅	❌	❌	✅*
: Chỉ khi là người tạo phiếu đó

Hành động	Admin	Phòng Cơ điện	Cơ điện xưởng	Người tạo	User khác
Xem dialog "Chi tiết / Kiểm kê"	✅	✅	✅	✅	✅
Xem danh sách máy đã quét	✅	✅	✅	✅	✅
Thêm vị trí kiểm kê	✅	✅	✅*	✅	❌
Quét QR/RFID	✅	✅	✅*	✅	❌
Lưu kết quả kiểm kê	✅	✅	✅*	✅	❌
Xóa máy khỏi chuyền	✅	✅	✅*	✅	❌
\: Cơ điện xưởng chỉ có quyền với đơn vị của mình (dựa vào id_department === phongban_id)
